/*
 Olives <VERSION> http://flams.github.com/olives
 The MIT License (MIT)
 Copyright (c) 2012-2013 Olivier Scherrer <pode.fr@gmail.com> - Olivier Wietrich <olivier.wietrich@gmail.com>
*/
define("DomUtils",["Tools"],function(i){return{getNodes:function(d,f){return this.isAcceptedType(d)?(d.parentNode||document.createDocumentFragment().appendChild(d),d.parentNode.querySelectorAll(f||"*")):false},getDataset:function(d){var f=0,b,h={},e,c;if(this.isAcceptedType(d))if(d.hasOwnProperty("dataset"))return d.dataset;else{for(b=d.attributes.length;f<b;f++)e=d.attributes[f].name.split("-"),e.shift()=="data"&&(h[c=e.join("-")]=d.getAttribute("data-"+c));return h}else return false},isAcceptedType:function(d){return d instanceof
HTMLElement||d instanceof SVGElement?true:false},setAttribute:function(d,f,b){return d instanceof HTMLElement?(d[f]=b,true):d instanceof SVGElement?(d.setAttribute(f,b),true):false},matches:function(d,f,b){return i.toArray(this.getNodes(d,f)).indexOf(b)>-1}}});
define("Bind.plugin",["Store","Observable","Tools","DomUtils"],function(i,d,f,b){return function(d,e){function c(b){j[b]&&(j[b].forEach(function(b){a.unwatchValue(b)}),delete j[b])}var a=null,g={},l={},j={};this.observers=j;this.setModel=function(b){return b instanceof i?(a=b,true):false};this.getModel=function(){return a};this.ItemRenderer=function(k,g){var e=null,d=null,h=null,j=null,i=null;this.setRenderer=function(a){e=a;return true};this.getRenderer=function(){return e};this.setRootNode=function(a){return b.isAcceptedType(a)?
(h=a,a=h.querySelector("*"),this.setRenderer(a),a&&h.removeChild(a),true):false};this.getRootNode=function(){return h};this.setPlugins=function(a){d=a;return true};this.getPlugins=function(){return d};this.items={};this.setStart=function(a){return j=parseInt(a,10)};this.getStart=function(){return j};this.setNb=function(a){return i=a=="*"?a:parseInt(a,10)};this.getNb=function(){return i};this.addItem=function(a){var b;return typeof a=="number"&&!this.items[a]?(b=this.getNextItem(a),(a=this.create(a))?
(b?h.insertBefore(a,b):h.appendChild(a),true):false):false};this.getNextItem=function(a){var b=Object.keys(this.items).map(function(a){return Number(a)}),c=f.closestGreater(a,b),b=b[c];if(b!=a)return this.items[b]};this.removeItem=function(a){var b=this.items[a];return b?(h.removeChild(b),delete this.items[a],c(a),true):false};this.create=function(c){if(a.has(c)){var k=e.cloneNode(true),g=b.getNodes(k);f.toArray(g).forEach(function(a){a.setAttribute("data-"+d.name+"_id",c)});this.items[c]=k;d.apply(k);
return k}};this.render=function(){var b=i=="*"?a.getNbItems():i,c=[];if(i!==null&&j!==null){f.loop(this.items,function(k,g){g=Number(g);(g<j||g>=j+b||!a.has(g))&&c.push(g)},this);c.sort(f.compareNumbers).reverse().forEach(this.removeItem,this);for(var k=j,g=b+j;k<g;k++)this.addItem(k);return true}else return false};this.setPlugins(k);this.setRootNode(g)};this.setItemRenderer=function(a,b){l[a||"default"]=b};this.getItemRenderer=function(a){return l[a]};this.foreach=function(b,g,f,d){var e=new this.ItemRenderer(this.plugins,
b);e.setStart(f||0);e.setNb(d||"*");e.render();a.watch("added",e.render,e);a.watch("deleted",function(a){e.render();c(a)},this);this.setItemRenderer(g,e)};this.updateStart=function(a,b){var c=this.getItemRenderer(a);return c?(c.setStart(b),true):false};this.updateNb=function(a,b){var c=this.getItemRenderer(a);return c?(c.setNb(b),true):false};this.refresh=function(a){return(a=this.getItemRenderer(a))?(a.render(),true):false};this.bind=function(c,g,e){var e=e||"",d=c.getAttribute("data-"+this.plugins.name+
"_id"),h=e.split("."),j=d||h.shift(),i=d?e:h.join("."),d=f.getNestedProperty(a.get(j),i),l=f.toArray(arguments).slice(3);if(d||d===0||d===false)this.execBinding.apply(this,[c,g,d].concat(l))||b.setAttribute(c,g,d);this.hasBinding(g)||c.addEventListener("change",function(){a.has(j)&&(i?a.update(j,e,c[g]):a.set(j,c[g]))},true);this.observers[j]=this.observers[j]||[];this.observers[j].push(a.watchValue(j,function(a){this.execBinding.apply(this,[c,g,f.getNestedProperty(a,i)].concat(l))||b.setAttribute(c,
g,f.getNestedProperty(a,i))},this))};this.set=function(c){return b.isAcceptedType(c)&&c.name?(a.set(c.name,c.value),true):false};this.getItemIndex=function(a){return(a=b.getDataset(a))&&typeof a[this.plugins.name+"_id"]!="undefined"?+a[this.plugins.name+"_id"]:false};this.form=function(a){if(a&&a.nodeName=="FORM"){var b=this;a.addEventListener("submit",function(c){f.toArray(a.querySelectorAll("[name]")).forEach(b.set,b);c.preventDefault()},true);return true}else return false};this.addBinding=function(a,
b){return a&&typeof a=="string"&&typeof b=="function"?(g[a]=b,true):false};this.execBinding=function(a,b){return this.hasBinding(b)?(g[b].apply(a,Array.prototype.slice.call(arguments,2)),true):false};this.hasBinding=function(a){return g.hasOwnProperty(a)};this.getBinding=function(a){return g[a]};this.addBindings=function(a){return f.loop(a,function(a,b){this.addBinding(b,a)},this)};this.setModel(d);this.addBindings(e)}});
define("Event.plugin",["DomUtils"],function(i){return function(d,f){var b=null,h={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},e=!!f;this.addEventListener=function(b,a,g,e){b.addEventListener(this.map(a),g,!!e)};this.listen=function(c,a,g,e){this.addEventListener(c,a,function(a){b[g].call(b,a,c)},!!e)};this.delegate=function(c,a,g,e,d){this.addEventListener(c,g,function(g){i.matches(c,a,g.target)&&b[e].call(b,g,c)},!!d)};this.getParent=function(){return b};this.setParent=function(c){return c instanceof
Object?(b=c,true):false};this.map=function(b){return e?h[b]||b:b};this.setMap=function(b,a){return typeof b=="string"&&typeof a=="string"?(h[b]=a,true):false};this.setParent(d)}});
define("LocalStore",["Store","Tools"],function(i,d){function f(){var b=null,f=localStorage,e=function(){f.setItem(b,this.toJSON())};this.setLocalStorage=function(b){return b&&b.setItem instanceof Function?(f=b,true):false};this.getLocalStorage=function(){return f};this.sync=function(c){return typeof c=="string"?(b=c,c=JSON.parse(f.getItem(c)),d.loop(c,function(a,b){this.has(b)||this.set(b,a)},this),e.call(this),this.watch("added",e,this),this.watch("updated",e,this),this.watch("deleted",e,this),true):
false}}return function(b){f.prototype=new i(b);return new f}});
define("Plugins",["Tools","DomUtils"],function(i,d){return function(f){var b={},h=function(b){return b.trim()},e=function(c,a,g){a.split(";").forEach(function(a){var e=a.split(":"),a=e[0].trim(),e=e[1]?e[1].split(",").map(h):[];e.unshift(c);b[g]&&b[g][a]&&b[g][a].apply(b[g],e)})};this.add=function(c,a){var e=this;return typeof c=="string"&&typeof a=="object"&&a?(b[c]=a,a.plugins={name:c,apply:function(){return e.apply.apply(e,arguments)}},true):false};this.addAll=function(b){return i.loop(b,function(a,
b){this.add(b,a)},this)};this.get=function(c){return b[c]};this.del=function(c){return delete b[c]};this.apply=function(b){var a;return d.isAcceptedType(b)?(a=d.getNodes(b),i.loop(i.toArray(a),function(a){i.loop(d.getDataset(a),function(b,c){e(a,b,c)})}),b):false};this.addAll(f)}});
define("OObject",["StateMachine","Store","Plugins","DomUtils","Tools"],function(i,d,f,b,h){return function(e){var c=function(a){var c=g||document.createElement("div");if(a.template){typeof a.template=="string"?c.innerHTML=a.template.trim():b.isAcceptedType(a.template)&&c.appendChild(a.template);if(c.childNodes.length>1)throw Error("UI.template should have only one parent node");else a.dom=c.childNodes[0];a.plugins.apply(a.dom)}else throw Error("UI.template must be set prior to render");},a=function(a,
b,c){b&&(c?b.insertBefore(a.dom,c):b.appendChild(a.dom),g=b)},g=null,l=new i("Init",{Init:[["render",c,this,"Rendered"],["place",function(b,e){c(b);a.apply(null,h.toArray(arguments))},this,"Rendered"]],Rendered:[["place",a,this],["render",c,this]]});this.model=e instanceof d?e:new d;this.plugins=new f;this.dom=this.template=null;this.place=function(a,b){l.event("place",this,a,b)};this.render=function(){l.event("render",this)};this.setTemplateFromDom=function(a){return b.isAcceptedType(a)?(this.template=
a,true):false};this.alive=function(a){return b.isAcceptedType(a)?(this.setTemplateFromDom(a),this.place(a.parentNode,a.nextElementSibling),true):false};this.getCurrentPlace=function(){return g}}});
define("Place.plugin",["OObject","Tools"],function(i,d){return function(f){var b={};this.place=function(d,e){if(b[e]instanceof i)b[e].place(d);else throw Error(e+" is not an OObject UI in place:"+e);};this.set=function(d,e){return typeof d=="string"&&e instanceof i?(b[d]=e,true):false};this.setAll=function(b){d.loop(b,function(b,c){this.set(c,b)},this)};this.get=function(d){return b[d]};this.setAll(f)}});
define("SocketIOTransport",["Observable","Tools"],function(){return function(i){var d=null;this.setSocket=function(f){return f&&typeof f.emit=="function"?(d=f,true):false};this.getSocket=function(){return d};this.on=function(f,b){return d.on(f,b)};this.once=function(f,b){return d.once(f,b)};this.emit=function(f,b,h){return d.emit(f,b,h)};this.removeListener=function(f,b,h){return d.removeListener(f,b,h)};this.request=function(d,b,h,e){return typeof d=="string"&&typeof b!="undefined"?(b={eventId:Date.now()+
Math.floor(Math.random()*1E6),data:b},this.once(b.eventId,function(){h&&h.apply(e||null,arguments)}),this.emit(d,b),true):false};this.listen=function(d,b,h,e){if(typeof d=="string"&&typeof b!="undefined"&&typeof h=="function"){var c={eventId:Date.now()+Math.floor(Math.random()*1E6),data:b,keepAlive:true},a=function(){h&&h.apply(e||null,arguments)},g=this;this.on(c.eventId,a);this.emit(d,c);return function(){g.emit("disconnect-"+c.eventId);g.removeListener(c.eventId,a)}}else return false};this.setSocket(i)}});
define("Stack",["Tools"],function(){var i=require("Tools");return function(d){function f(a){if(!(a>=e.length)){var c=e[a];return i.toArray(b.childNodes).indexOf(c)==-1?f(a+1):c}}var b=document.createDocumentFragment(),h=document.createElement("div"),e=[],c=null;this.add=function(a){return!this.has(a)&&a instanceof HTMLElement?(b.appendChild(a),e.push(a),a):false};this.remove=function(a){var c;return this.has(a)?(c=e.indexOf(a),b.removeChild(a),e.splice(c,1),a):false};this.place=function(a){return a instanceof
HTMLElement?([].slice.call(b.childNodes).forEach(function(b){this.has(b)&&a.appendChild(b)},this),this._setParent(a)):false};this.up=function(a){if(this.has(a)){var b=this.getPosition(a);this.move(a,b+1);return a}else return false};this.down=function(a){if(this.has(a)){var b=this.getPosition(a);this.move(a,b-1);return a}else return false};this.move=function(a,c){if(this.has(a)){var d=e.indexOf(a);e.splice(d,1);(d=f(c))?b.insertBefore(a,d):b.appendChild(a);e.splice(c,0,a);return a}else return false};
this.insert=function(a,c){return!this.has(a)&&a instanceof HTMLElement?(e.splice(c,0,a),b.insertBefore(a,b.childNodes[c]),a):false};this.getPosition=function(a){return e.indexOf(a)};this.count=function(){return b.childNodes.length};this.has=function(a){return this.getPosition(a)>=0};this.hide=function(a){return this.has(a)?(h.appendChild(a),true):false};this.show=function(a){return this.has(a)&&a.parentNode===h?(this.move(a,e.indexOf(a)),true):false};this.hideAll=function(){e.forEach(this.hide,this)};
this.showAll=function(){e.forEach(this.show,this)};this.getParent=function(){return b};this._setParent=function(a){return a instanceof HTMLElement?b=a:false};this.getHidePlace=function(){return h};this.setHidePlace=function(a){return a instanceof HTMLElement?(h=a,true):false};this.getLastTransit=function(){return c};this.transit=function(a){c&&this.hide(c);return this.show(a)?(c=a,true):false};this._setParent(d)}});
define("LocationRouter",["Router","Tools"],function(i,d){function f(){function b(){window.location.hash?this.navigate.apply(this,this.parse(window.location.hash)):this.navigate(e)}var f,e="",c=window.location.hash;this.setDefaultRoute=function(a){return a&&typeof a=="string"?(e=a,true):false};this.getDefaultRoute=function(){return e};this.parse=function(a){return a.split("#").pop().split("/")};this.toUrl=function(a){return a.join("/")};this.start=function(a){this.setDefaultRoute(a);b.call(this);this.bindOnHashChange();
this.bindOnRouteChange()};this.destroy=function(){this.unwatch(f);window.removeEventListener("hashchange",this.boundOnHashChange,true)};this.onHashChange=function(){window.location.hash!=c&&b.call(this)};this.boundOnHashChange=this.onHashChange.bind(this);this.bindOnHashChange=function(){window.addEventListener("hashchange",this.boundOnHashChange,true)};this.bindOnRouteChange=function(){f=this.watch(this.onRouteChange,this)};this.onRouteChange=function(){window.location.hash=this.toUrl(d.toArray(arguments));
c=window.location.hash};this.getLastRoute=function(){return c}}return function(){f.prototype=new i;return new f}});
