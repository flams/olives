/*
 Emily <VERSION> http://flams.github.com/emily

 The MIT License (MIT)

 Copyright (c) 2012-2013 Olivier Scherrer <pode.fr@gmail.com>
*/
(function(d){if("function"==typeof bootstrap)bootstrap("emily",d);else if("object"==typeof exports)module.exports=d();else if("function"==typeof define&&define.amd)define(d);else if("undefined"!=typeof ses){if(ses.ok())ses.makeEmily=d}else"undefined"!=typeof window?window.emily=d():global.emily=d()})(function(){return function(d,h,j){function a(c,g){if(!h[c]){if(!d[c]){var f=typeof require=="function"&&require;if(!g&&f)return f(c,true);if(b)return b(c,true);throw Error("Cannot find module '"+c+"'");
}f=h[c]={exports:{}};d[c][0].call(f.exports,function(b){var i=d[c][1][b];return a(i?i:b)},f,f.exports)}return h[c].exports}for(var b=typeof require=="function"&&require,c=0;c<j.length;c++)a(j[c]);return a}({1:[function(d,h){h.exports={Observable:d("./Observable"),StateMachine:d("./StateMachine"),Store:d("./Store"),Tools:d("./Tools"),Promise:d("./Promise"),Transport:d("./Transport")}},{"./Observable":2,"./StateMachine":3,"./Store":4,"./Tools":5,"./Promise":6,"./Transport":7}],5:[function(d,h){(function(){function d(a,
b,c){var e,g;if(b)return b.forEach(function(b,m){var i=c(b,a);if(i>=0&&(typeof g=="undefined"||i<g))g=i,e=m}),e}h.exports={getGlobal:function(){return function(){return this}.call(null)},mixin:function(a,b,c){this.loop(a,function(e,g){if(!b[g]||!c)b[g]=a[g]});return b},count:function(a){var b=0;this.loop(a,function(){b++});return b},compareObjects:function(a,b){return Object.getOwnPropertyNames(a).sort().join("")==Object.getOwnPropertyNames(b).sort().join("")},compareNumbers:function(a,b){return a>
b?1:a<b?-1:0},toArray:function(a){return[].slice.call(a)},loop:function(a,b,c){var e;if(a instanceof Object&&b instanceof Function){if(a instanceof Array)for(e=0;e<a.length;e++)b.call(c,a[e],e,a);else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a);return true}else return false},objectsDiffs:function(a,b){if(a instanceof Object&&b instanceof Object){var c=[],e=[],g=[],f=[];this.loop(b,function(b,i){typeof a[i]=="undefined"?f.push(i):b!==a[i]?e.push(i):b===a[i]&&c.push(i)});this.loop(a,function(a,
c){typeof b[c]=="undefined"&&g.push(c)});return{updated:e,unchanged:c,added:f,deleted:g}}else return false},jsonify:function(a){return a instanceof Object?JSON.parse(JSON.stringify(a)):false},clone:function(a){return a instanceof Array?a.slice(0):typeof a=="object"&&a!==null&&!(a instanceof RegExp)?this.mixin(a,{}):false},getNestedProperty:function(a,b){return a&&a instanceof Object?typeof b=="string"&&b!==""?b.split(".").reduce(function(a,b){return a&&a[b]},a):typeof b=="number"?a[b]:a:a},setNestedProperty:function(a,
b,c){if(a&&a instanceof Object)if(typeof b=="string"&&b!==""){var e=b.split(".");return e.reduce(function(a,b,d){a[b]=a[b]||{};e.length==d+1&&(a[b]=c);return a[b]},a)}else return typeof b=="number"?(a[b]=c,a[b]):a;else return a},closest:function(a,b){return d(a,b,function(a,b){return Math.abs(a-b)})},closestGreater:function(a,b){return d(a,b,function(a,b){return a-b})},closestLower:function(a,b){return d(a,b,function(a,b){return b-a})}}})()},{}],7:[function(d,h){h.exports=function(d){var a=null;this.setReqHandlers=
function(b){return b instanceof Object?(a=b,true):false};this.getReqHandlers=function(){return a};this.request=function(b,c,e,g){return a.has(b)&&typeof c!="undefined"?(a.get(b)(c,function(){e&&e.apply(g,arguments)}),true):false};this.listen=function(b,c,e,g){if(a.has(b)&&typeof c!="undefined"&&typeof e=="function"){var f=function(){e.apply(g,arguments)},d;d=a.get(b)(c,f,f);return function(){typeof d=="function"?d():typeof d=="object"&&typeof d.func=="function"&&d.func.call(d.scope)}}else return false};
this.setReqHandlers(d)}},{}],2:[function(d,h){var j=d("./Tools");h.exports=function(){var a={};this.watch=function(b,c,e){if(typeof c=="function"){var g=a[b]=a[b]||[],c=[c,e];g.push(c);return[b,g.indexOf(c)]}else return false};this.unwatch=function(b){var c=b[0],b=b[1];return a[c]&&a[c][b]?(delete a[c][b],a[c].some(function(a){return!!a})||delete a[c],true):false};this.notify=function(b){var c=a[b],e=j.toArray(arguments).slice(1);return c?(j.loop(c,function(a){try{a&&a[0].apply(a[1]||null,e)}catch(b){}}),
true):false};this.hasObserver=function(b){return!(!b||!a[b[0]]||!a[b[0]][b[1]])};this.hasTopic=function(b){return!!a[b]};this.unwatchAll=function(b){a[b]?delete a[b]:a={};return true}}},{"./Tools":5}],3:[function(d,h){function j(){var b={};this.add=function(a,e,g,d){var m=[];if(b[a])return false;return typeof a=="string"&&typeof e=="function"?(m[0]=e,typeof g=="object"&&(m[1]=g),typeof g=="string"&&(m[2]=g),typeof d=="string"&&(m[2]=d),b[a]=m,true):false};this.has=function(a){return!!b[a]};this.get=
function(a){return b[a]||false};this.event=function(c){var e=b[c];return e?(e[0].apply(e[1],a.toArray(arguments).slice(1)),e[2]):false}}var a=d("./Tools");h.exports=function(b,c){var e={},d="";this.init=function(a){return e[a]?(d=a,true):false};this.add=function(a){return e[a]?e[a]:e[a]=new j};this.get=function(a){return e[a]};this.getCurrent=function(){return d};this.has=function(a){return e.hasOwnProperty(a)};this.advance=function(a){return this.has(a)?(d=a,true):false};this.event=function(b){var c;
c=e[d].event.apply(e[d].event,a.toArray(arguments));return c===false?false:(c&&(e[d].event("exit"),d=c,e[d].event("entry")),true)};a.loop(c,function(a,b){var c=this.add(b);a.forEach(function(a){c.add.apply(null,a)})},this);this.init(b)}},{"./Tools":5}],4:[function(d,h){var j=d("./Observable"),a=d("./Tools");h.exports=function(b){var c=a.clone(b)||{},e=new j,d=new j,f=[],h=function(b){var n=a.objectsDiffs(b,c);["updated","deleted","added"].forEach(function(a){n[a].forEach(function(b){e.notify(a,b,
c[b]);d.notify(b,c[b],a)})})};this.count=this.getNbItems=function(){return c instanceof Array?c.length:a.count(c)};this.get=function(a){return c[a]};this.has=function(a){return c.hasOwnProperty(a)};this.set=function(a,b){var l,f;return typeof a!="undefined"?(l=this.has(a),f=this.get(a),c[a]=b,l=l?"updated":"added",e.notify(l,a,c[a],f),d.notify(a,c[a],l,f),true):false};this.update=function(b,c,l){var f;return this.has(b)?(f=this.get(b),a.setNestedProperty(f,c,l),e.notify("updated",c,l),d.notify(b,
f,"updated"),true):false};this.del=function(a){return this.has(a)?(this.alter("splice",a,1)||(delete c[a],e.notify("deleted",a),d.notify(a,c[a],"deleted")),true):false};this.delAll=function(b){return b instanceof Array?(b.sort(a.compareNumbers).reverse().forEach(this.del,this),true):false};this.alter=function(b){var d,e;return c[b]?(e=a.clone(c),d=this.proxy.apply(this,arguments),h(e),d):false};this.proxy=function(a){return c[a]?c[a].apply(c,Array.prototype.slice.call(arguments,1)):false};this.watch=
function(a,b,c){return e.watch(a,b,c)};this.unwatch=function(a){return e.unwatch(a)};this.getStoreObservable=function(){return e};this.watchValue=function(a,b,c){return d.watch(a,b,c)};this.unwatchValue=function(a){return d.unwatch(a)};this.getValueObservable=function(){return d};this.loop=function(b,d){a.loop(c,b,d)};this.reset=function(b){if(b instanceof Object){var d=a.clone(c);c=a.clone(b)||{};h(d);return true}else return false};this.compute=function(b,c,d,e){return typeof b=="string"&&typeof c==
"object"&&typeof d=="function"&&!this.isCompute(b)?(f[b]=[],a.loop(c,function(a){f[b].push(this.watchValue(a,function(){this.set(b,d.call(e))},this))},this),this.set(b,d.call(e)),true):false};this.removeCompute=function(b){return this.isCompute(b)?(a.loop(f[b],function(a){this.unwatchValue(a)},this),this.del(b),true):false};this.isCompute=function(a){return!!f[a]};this.toJSON=function(){return JSON.stringify(c)};this.dump=function(){return c}}},{"./Observable":2,"./Tools":5}],6:[function(d,h){var j=
d("./Observable"),a=d("./StateMachine");h.exports=function c(){var d=null,g=null,f=new j,h={Pending:[["fulfill",function(a){d=a;f.notify("fulfill",a)},"Fulfilled"],["reject",function(a){g=a;f.notify("reject",a)},"Rejected"],["toFulfill",function(a){f.watch("fulfill",a)}],["toReject",function(a){f.watch("reject",a)}]],Fulfilled:[["toFulfill",function(a){setTimeout(function(){a(d)},0)}]],Rejected:[["toReject",function(a){setTimeout(function(){a(g)},0)}]]},i=new a("Pending",h);this.fulfill=function(a){i.event("fulfill",
a);return this};this.reject=function(a){i.event("reject",a);return this};this.then=function(a,f,h,j){var k=new c;a instanceof Function?f instanceof Function?i.event("toFulfill",this.makeResolver(k,a)):i.event("toFulfill",this.makeResolver(k,a,f)):i.event("toFulfill",this.makeResolver(k,function(){k.fulfill(d)}));f instanceof Function&&i.event("toReject",this.makeResolver(k,f,h));h instanceof Function&&i.event("toReject",this.makeResolver(k,h,j));!(f instanceof Function)&&!(h instanceof Function)&&
i.event("toReject",this.makeResolver(k,function(){k.reject(g)}));return k};this.sync=function(a){return a instanceof Object&&a.then?(a.then(function(a){this.fulfill(a)}.bind(this),function(a){this.reject(a)}.bind(this)),true):false};this.makeResolver=function(a,c,d){return function(e){var f;try{f=c.call(d,e),a.sync(f)||a.fulfill(f)}catch(g){a.reject(g)}}};this.getReason=function(){return g};this.getValue=function(){return d};this.getObservable=function(){return f};this.getStateMachine=function(){return i};
this.getStates=function(){return h}}},{"./Observable":2,"./StateMachine":3}]},{},[1])(1)});
